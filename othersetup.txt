othersetup.txt
Custom Setup for Windows 10 (Windows 10 Version 20H2 - OS Build 19042)
	https://github.com/jfu299/win10setup
	https://raw.githubusercontent.com/jfu299/win10setup/main/othersetup.txt
By: Justin Fu
Updated: July 7 2021

1) Take over permissions of Registry Keys

	Take Full Ownership and Control:

		HKCR\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}\ShellFolder
		HKCR\CLSID\{B4FB3F98-C1EA-428d-A78A-D1F5659CBA93}\ShellFolder
		HKCR\Wow6432Node\CLSID\{B4FB3F98-C1EA-428d-A78A-D1F5659CBA93}\ShellFolder
		HKCR\Wow6432Node\CLSID\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}\ShellFolder
		HKLM\SYSTEM\CurrentControlSet\Services\wuauserv
		HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge
		HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge
		HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge Update
	
	Deny Everyone Access (After disabling these services):

		HKLM\SYSTEM\CurrentControlSet\Services\WaaSMedicSvc
		HKLM\SYSTEM\CurrentControlSet\Services\DiagTrack

2) Run setup.bat file

3) OneDrive

	- Take ownership and set Deny All to OneDriveSetup.exe in System32 and SysWOW64
		- %windir%\System32\OneDriveSetup.exe
		- %windir%\SysWOW64\OneDriveSetup.exe

4) Settings Page

	- Night Light Settings
	- Focus Assist
	- Bluetooth
	- Wi-fi/Ethernet
	- Touchpad Settings
	- Default Web Browser
	- Time and Language
	- Windows Defender

5) Group Policy

	- Computer Configuration > Administrative Templates > System > Logon >> Show First Sign-In Animation: DISABLED

	- Computer Configuration > Administrative Templates > Windows Components > OOBE >> Don't launch privacy settings experience on user logon: ENABLED

6) Windows 10 Updates

	- Update
	- Pause Updates
	- Update Deferral

	- Computer Configuration > Administrative Templates > Windows Components > Windows Update
	- Computer Configuration > Administrative Templates > Windows Components > Windows Update > Windows Update for Business

7) Windows Update Medic Service Disable: WaaSMedicSvc

	- Must Take Ownership and Deny Everyone Access Registry Key to fully disable
		- HKLM\SYSTEM\CurrentControlSet\Services\WaaSMedicSvc

8) Ease of Access

	- Take ownership and set Deny All to Utilman.exe in System32 and SysWOW64
		- %windir%\System32\Utilman.exe
		- %windir%\SysWOW64\Utilman.exe


9) Disk Cleanup (Run as Administrator)

	- DO NOT Select the Downloads Folder
	Other Temp Folders
		- %temp% (%windir%\Temp)
		- %UserProfile%\AppData\Local\Temp
		- %UserProfile%\AppData\LocalLow\Temp

10) Microsoft Edge Chromium Uninstall

	- Remove Microsoft Edge Shortcuts
		- %UserProfile%\Desktop
		- %UserProfile%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs
		- %ProgramData%\Microsoft\Windows\Start Menu\Programs

	
	--- If setup.bat was not able to fully uninstall Microsoft Edge: ---

	- Use Administrator Powershell or Command Prompt

	- Go to this Folder (Insert Version Number into the Version Number Section):
	
		C:\Program Files (x86)\Microsoft\Edge\Application\[VERSION NUMBER HERE]\Installer

	- Copy and Paste This In:

		setup.exe --uninstall --system-level --verbose-logging --force-uninstall

	- Take Ownership and Full Control, and then delete these Registry Keys

		HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge

		HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft Edge

11) Firefox Web Browser about:config Settings
		
	- Insert custom userChrome.css file into Profile (Roaming)
		- toolkit.legacyUserProfileCustomizations.stylesheets
				true
	
	- security.secure_connection_icon_color_gray
		false
	- browser.newtabpage.activity-stream.asrouter.providers.whats-new-panel	
  		{"id":"whats-new-panel","enabled":false,"type":"remote-settings","bucket":"whats-new-panel","updateCycleInMs":3600000}
	- identity.mobilepromo.android
  		(LEAVE BLANK)
	- identity.mobilepromo.ios
  		(LEAVE BLANK)
	- identity.sendtabpromo.url
  		(LEAVE BLANK)
	- security.insecure_connection_icon.enabled
		true	
	- security.insecure_connection_text.enabled
		true
	- security.insecure_connection_icon.pbmode.enabled
		true		
	- security.insecure_connection_text.pbmode.enabled
		true

12) Remove Start Menu Bloat 

	--- setup.bat already does Option 1 ---

	- Open Administrator Powershell and Copy/Paste an Option
	- Update Apps that you keep after running the powershell command

Option 1: (Keep Store and Calculator and Windows Terminal) (Option 1 is already included in setup.bat file)

Get-AppxPackage | where-object {$_.name -notlike "*store*"} | where-object {$_.name -notlike "*terminal*"} | where-object {$_.name -notlike "*calc*"} | Remove-AppxPackage

Option 2: (Keep Calculator and Windows Terminal Only)

Get-AppxPackage | where-object {$_.name -notlike "*calc*"} | where-object {$_.name -notlike "*terminal*"} | Remove-AppxPackage

Option 3: (Remove Everything)

Get-AppxPackage | Remove-AppxPackage

Remove Microsoft Store Only:

Get-AppxPackage *windowsstore* | Remove-AppxPackage

Undo Everything:

Get-AppxPackage -allusers *store* | Foreach {Add-AppxPackage -DisableDevelopmentMode -Register "$($_.InstallLocation)\AppXManifest.xml"}

-----
